<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>GAIN AUNTU ‚Äî Profile & CV</title>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0b0f14; --card:#121922; --text:#e6edf3; --muted:#9fb2c7;
      --accent:#4da3ff; --chip:#1b2633; --border:#223041;
      --accent-2:#8a7dff; --accent-3:#00e6b8;
      --ring: drop-shadow(0 0 8px rgba(77,163,255,.35)) drop-shadow(0 0 22px rgba(0,230,184,.18));
      --focus: 0 0 0 3px rgba(77,163,255,.45);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      color:var(--text);
      background:
        radial-gradient(1200px 800px at 10% -10%, #0f1622 0, #0b0f14 40%, #0b0f14 100%),
        radial-gradient(800px 600px at 120% 0%, rgba(77,163,255,.08), transparent 60%),
        radial-gradient(800px 600px at -20% 100%, rgba(0,230,184,.06), transparent 60%);
      zoom:1.07;
      perspective: 1200px;
    }
    @supports not (zoom:1){
      .wrap{ transform: scale(1.07); transform-origin: top center; width: calc(100% / 1.07); }
    }
    .wrap{max-width:980px;margin:0 auto;padding:24px 18px 64px; position:relative}

    header{
      display:flex;align-items:center;justify-content:space-between;gap:12px;padding:18px;
      background:linear-gradient(180deg, rgba(18,25,34,.7), rgba(18,25,34,.6));
      border:1px solid var(--border);border-radius:16px;position:sticky;top:10px;z-index:6;
      backdrop-filter:saturate(140%) blur(8px);
      box-shadow: 0 10px 30px rgba(0,0,0,.35);
      outline: 1px solid rgba(77,163,255,.08);
      transition: transform .25s ease, opacity .25s ease;
    }
    .id{display:flex;align-items:center;gap:14px;}
    .avatar{width:48px;height:48px;border-radius:12px;
      background:
        conic-gradient(from 0deg, rgba(77,163,255,.35), rgba(0,230,184,.25), rgba(138,125,255,.3), rgba(77,163,255,.35)),
        linear-gradient(135deg,#2a3a4f,#1f2a38);
      display:grid;place-items:center;font-weight:700;filter:var(--ring);
    }
    .id h1{font-size:20px;line-height:1.2;margin:0}
    .id p{margin:0;color:var(--muted);font-size:13px}
    .links a{color:var(--accent)}
    .right-rail{display:flex;flex-direction:column;gap:10px;align-items:flex-end}
    .lang-group{display:flex; flex-direction:column; align-items:flex-start; gap:10px;}

    .lang-switch, .theme-switch{
      display:inline-flex;border:1px solid var(--border);background:var(--chip);
      border-radius:14px;padding:5px;gap:5px;position:relative;overflow:hidden;
    }
    .lang-switch:before, .theme-switch:before{
      content:""; position:absolute; inset:-150% -60%; background:
      radial-gradient(600px 600px at 15% 20%, rgba(77,163,255,.07), transparent 50%),
      radial-gradient(400px 400px at 85% 30%, rgba(0,230,184,.07), transparent 50%);
      pointer-events:none; filter:blur(10px);
      transition:transform .5s ease;
    }
    .lang-switch button, .theme-switch button{
      appearance:none;border:0;padding:9px 13px;border-radius:10px;background:transparent;color:var(--text);
      font-weight:600;cursor:pointer;font-size:13px;letter-spacing:.2px;transition: transform .12s ease, background .2s ease, box-shadow .15s ease;
    }
    .lang-switch button:hover, .theme-switch button:hover{ transform: translateY(-1px); }
    .lang-switch button:focus-visible, .theme-switch button:focus-visible{ box-shadow: var(--focus); outline: none; }
    .lang-switch button.active, .theme-switch button.active{
      background: linear-gradient(135deg, var(--accent), var(--accent-3));
      color:#001428; box-shadow: 0 0 0 1px rgba(0,0,0,.25) inset;
      text-shadow: 0 1px 0 rgba(255,255,255,.25);
    }

    .actions{display:flex;gap:8px;flex-wrap:wrap;justify-content:flex-end}
    .btn{
      appearance:none; border:1px solid var(--border); background:var(--chip); color:var(--text);
      padding:8px 12px; border-radius:10px; cursor:pointer; font-weight:600; font-size:13px;
      transition: transform .12s ease, box-shadow .15s ease, background .2s ease;
    }
    .btn:hover{ transform: translateY(-1px); }
    .btn:focus-visible{ outline:none; box-shadow: var(--focus); }
    .btn-accent{ background:linear-gradient(135deg, var(--accent), var(--accent-3)); color:#001428; }

    main{margin-top:18px;display:grid;gap:16px}
    section{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:12px}

    [data-lang]{display:none; opacity:0; transform: translateY(6px); transition: opacity .28s ease, transform .28s ease;}
    [data-lang][data-show="true"]{display:block; opacity:1; transform: translateY(0);}

    .viewer{position:relative; transform-style: preserve-3d;}
    .viewer .pdf-wrap{position:relative;border-radius:12px;overflow:hidden;background:transparent}
    .viewer .pdf-topfade{position:absolute;inset:0 auto auto 0;height:16px;width:100%;pointer-events:none;background:linear-gradient(to bottom, #0b0f14, rgba(0,0,0,0))}
    .viewer .pdf-frame{width:100%;height:84vh;border:0;display:block;opacity:0;transition:opacity .25s ease; transform: translateZ(0.01px);}
    .viewer .pdf-frame.ready{opacity:1}
    .viewer.viewer-dark .pdf-frame{filter: invert(0.92) hue-rotate(180deg)}
    .viewer.viewer-dark .pdf-topfade{background:linear-gradient(to bottom, #0b0f14, rgba(0,0,0,0))}

    .viewer .iframe-shell{border:1px solid var(--border);border-radius:12px;overflow:hidden;background:#fff; padding:20px 24px; position:relative}
    .viewer.viewer-dark .iframe-shell{background:#0f1622;}
    .viewer .kr{width:100%;height:84vh;border:0;display:block;background:transparent; transform: translateZ(0.01px)}
    .viewer.viewer-dark .kr{filter: invert(0.92) hue-rotate(180deg)}

    /* Loader */
    .loader{
      position:absolute; inset:0; display:grid; place-items:center; background:linear-gradient(180deg, rgba(15,22,34,.35), rgba(15,22,34,.2));
      pointer-events:none; opacity:0; transform: scale(.98); transition: opacity .25s ease, transform .25s ease;
    }
    .loader.show{ opacity:1; transform: scale(1); }
    .ring{
      width:36px;height:36px;border-radius:50%;
      background: conic-gradient(from 0deg, var(--accent), var(--accent-2), var(--accent-3), var(--accent));
      -webkit-mask: radial-gradient(farthest-side, transparent 55%, #000 56%);
              mask: radial-gradient(farthest-side, transparent 55%, #000 56%);
      animation: spin 1s linear infinite;
      filter:var(--ring);
    }
    @keyframes spin{ to{ transform: rotate(1turn); } }

    /* Parallax glow */
    .parallax-glow{
      position: fixed;
      left: 50%; top: 50%;
      width: 900px; height: 900px;
      margin-left: -450px; margin-top: -450px;
      pointer-events: none; z-index: 0;
      background:
        radial-gradient(closest-side,
          color-mix(in srgb, var(--accent) 35%, transparent),
          transparent 70%);
      filter: blur(60px) saturate(120%);
      opacity: .45;
      transform: translate3d(0,0,0) scale(1);
      transition: opacity .25s ease;
    }

    .foot{margin-top:24px;color:var(--muted);font-size:12px;text-align:center; position:relative; z-index:1}

    /* Toasts */
    .toast{
      position: fixed; bottom: 18px; right: 18px; z-index: 20;
      display: grid; gap: 8px;
    }
    .toast .t{
      background: linear-gradient(180deg, rgba(18,25,34,.95), rgba(18,25,34,.88));
      border: 1px solid var(--border); color: var(--text); font-size: 13px;
      padding: 10px 12px; border-radius: 10px; box-shadow: 0 6px 20px rgba(0,0,0,.35);
      opacity: 0; transform: translateY(6px); transition: opacity .2s ease, transform .2s ease;
    }
    .toast .t.show{ opacity: 1; transform: translateY(0); }

    /* Progress bar */
    .progress{
      position: fixed; inset: 0 0 auto 0; height: 3px; z-index: 10; pointer-events:none;
      background: linear-gradient(90deg, var(--accent), var(--accent-3));
      transform-origin: 0 50%; transform: scaleX(0);
      box-shadow: 0 0 12px rgba(77,163,255,.5);
    }

    @media (prefers-reduced-motion: reduce){
      .lang-switch button:hover, .theme-switch button:hover{ transform:none; }
      [data-lang]{ transition:none; }
      .viewer .pdf-frame{ transition:none; }
      .loader{ transition:none; }
      .toast .t{ transition:none; }
      .parallax-glow{ display:none; }
    }

    @media print{
      :root{ --text:#000; --rule:#ccc; }
      body{ zoom:1; background:#fff; color:#000; }
      header, .loader, .pdf-topfade, .actions, .toast, .progress, .parallax-glow{ display:none !important; }
      .wrap{ max-width:100%; padding:0; }
      main{ margin:0; gap:0; }
      section{ border:0; border-radius:0; padding:0; }
      [data-lang]{ display:block !important; opacity:1 !important; transform:none !important; }
      .viewer .pdf-frame, .viewer .kr{ height:auto; min-height:0; filter:none !important; }
      .viewer .iframe-shell{ background:#fff; padding:0; border:0; }
      .foot{ color:#444; }
    }
  </style>

  <style id="han-font-fix">
    #btn-ko { font-family: 'Noto Sans KR', system-ui, sans-serif !important; line-height: 1; position: relative; top: -1px; }
  </style>
</head>
<body>
  <div class="progress" id="bar"></div>
  <div class="parallax-glow" id="glow" aria-hidden="true"></div>

  <div class="wrap">
    <header id="hdr">
      <div class="id">
        <div class="avatar">AG</div>
        <div>
          <h1>GAIN AUNTU</h1>
          <p>Embedded Systems & Computer Vision ‚Ä¢ Suwon, Korea</p>
          <div class="links" style="margin-top:6px; font-size:13px">
            <a href="mailto:gainauntu@gmail.com">gainauntu@gmail.com</a> ¬∑
            <a href="tel:+821028186879">(+82) 10-2818-6879</a> ¬∑
            <a href="https://github.com/gainauntu" target="_blank" rel="noreferrer">GitHub</a> ¬∑
            <a href="https://www.linkedin.com/in/gainauntu/">LinkedIn</a>
          </div>
        </div>
      </div>

      <div class="right-rail">
        <div class="lang-group">
          <div class="lang-switch" role="group" aria-label="Language toggle">
            <button id="btn-en" class="active" data-target="en" aria-pressed="true" title="English">EN</button>
            <button id="btn-ko" data-target="ko" aria-pressed="false" title="ÌïúÍµ≠Ïñ¥">Ìïú</button>
          </div>
          <div class="theme-switch" role="group" aria-label="Viewer theme toggle">
            <button id="theme-light" aria-pressed="false" title="Light">‚òÄÔ∏è</button>
            <button id="theme-dark" aria-pressed="false" title="Dark">üåô</button>
          </div>
        </div>
        <div class="actions">
          <button id="btn-copy-email" class="btn" title="Copy email">Copy Email</button>
          <a id="btn-download-pdf" class="btn btn-accent" title="Download PDF" href="CV_AUNTU_GAIN.pdf" download>Download PDF</a>
        </div>
      </div>
    </header>

    <main>
      <div id="viewer" class="viewer">
        <!-- English -->
        <section data-lang="en" data-show="true" id="en-cv">
          <div class="pdf-wrap">
            <div class="loader show" id="pdfLoader"><div class="ring"></div></div>
            <div class="pdf-topfade"></div>
            <iframe class="pdf-frame" id="pdfFrame"
              src="CV_AUNTU_GAIN.pdf#toolbar=0&navpanes=0&statusbar=0&view=FitH"
              title="CV PDF"></iframe>
          </div>
        </section>

        <!-- Korean (External HTML) -->
        <section data-lang="ko" data-show="false" id="kr">
          <div class="iframe-shell">
            <div class="loader" id="krLoader"><div class="ring"></div></div>
            <iframe id="krFrame" class="kr" title="ÌïúÍµ≠Ïñ¥ ÌéòÏù¥ÏßÄ"></iframe>
          </div>
        </section>
      </div>

      <div class="foot">¬© <span id="y"></span> GAIN AUNTU</div>
    </main>
  </div>

  <!-- html2pdf (for http/https auto-download path) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<script>
(function(){
  const $ = sel => document.querySelector(sel);

  const btnEn = $('#btn-en');
  const btnKo = $('#btn-ko');
  const themeLight = $('#theme-light');
  const themeDark = $('#theme-dark');
  const viewer = $('#viewer');
  const pdfFrame = $('#pdfFrame');
  const krFrame = $('#krFrame');
  const pdfLoader = $('#pdfLoader');
  const krLoader = $('#krLoader');
  const btnCopyEmail = $('#btn-copy-email');
  const btnDownloadPDF = $('#btn-download-pdf');
  const bar = $('#bar');
  const glow = $('#glow');

  const KR_URL = 'KOREAN_AUNTU.html';
  let krLoaded = false;

  /* ---------- Toasts ---------- */
  const toastBox = (function(){
    const box = document.createElement('div');
    box.className = 'toast';
    document.body.appendChild(box);
    return box;
  })();
  function toast(msg){
    const t = document.createElement('div');
    t.className = 't';
    t.textContent = msg;
    toastBox.appendChild(t);
    requestAnimationFrame(()=> t.classList.add('show'));
    setTimeout(()=>{
      t.classList.remove('show');
      setTimeout(()=> t.remove(), 250);
    }, 1600);
  }

  /* ---------- Language / Theme ---------- */
  function showLang(lang){
    localStorage.setItem('ga_lang', lang);
    btnEn.classList.toggle('active', lang==='en'); btnEn.setAttribute('aria-pressed', String(lang==='en'));
    btnKo.classList.toggle('active', lang==='ko'); btnKo.setAttribute('aria-pressed', String(lang==='ko'));
    const en = document.querySelector('section[data-lang="en"]');
    const ko = document.querySelector('section[data-lang="ko"]');
    en.setAttribute('data-show', String(lang==='en'));
    ko.setAttribute('data-show', String(lang==='ko'));
    btnDownloadPDF.textContent = (lang === 'ko') ? 'Print Korean PDF' : 'Download PDF';

    if(lang==='en') tryReloadPDF();
    if(lang==='ko' && !krLoaded){
      try{
        if(krLoader) krLoader.classList.add('show');
        krFrame.removeAttribute('src');
        krFrame.setAttribute('src', KR_URL);
        krLoaded = true;
        setTimeout(function(){ syncKRTheme(); resizeKR(); }, 250);
      }catch(e){ console.error(e); }
    }
  }

  function applyViewerTheme(theme){
    localStorage.setItem('ga_viewer_theme', theme);
    const isDark = theme === 'dark';
    viewer.classList.toggle('viewer-dark', isDark);
    themeLight.classList.toggle('active', !isDark); themeLight.setAttribute('aria-pressed', String(!isDark));
    themeDark.classList.toggle('active', isDark);  themeDark.setAttribute('aria-pressed', String(isDark));
    syncKRTheme();
  }

  (function initThemeFirstVisit(){
    var saved = localStorage.getItem('ga_viewer_theme');
    if(!saved){
      try{
        var prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
        applyViewerTheme(prefersDark ? 'dark' : 'light');
      }catch(e){}
    }
  })();

  function tryReloadPDF(){
    try{
      if(pdfFrame){
        const src = pdfFrame.getAttribute('src');
        if(src) pdfFrame.setAttribute('src', src); else pdfFrame.src = pdfFrame.src;
      }
    }catch(e){}
  }

  function syncKRTheme(){
    try{
      const isDark = viewer.classList.contains('viewer-dark');
      const doc = krFrame.contentDocument || krFrame.contentWindow.document;
      if(doc && doc.documentElement){
        doc.documentElement.classList.toggle('theme-dark', isDark);
        doc.documentElement.classList.toggle('theme-light', !isDark);
      }
    }catch(e){}
  }

  function resizeKR(){
    try{
      const doc = krFrame.contentDocument || krFrame.contentWindow.document;
      const h = Math.max( doc.body.scrollHeight, doc.documentElement.scrollHeight );
      if(h && h > 600){ krFrame.style.height = Math.min(h + 20, window.innerHeight * 1.5) + 'px'; }
    }catch(e){}
  }

  // listeners
  btnEn.addEventListener('click', function(){ showLang('en'); });
  btnKo.addEventListener('click', function(){ showLang('ko'); });
  themeLight.addEventListener('click', function(){ applyViewerTheme('light'); toast('Light theme'); });
  themeDark.addEventListener('click', function(){ applyViewerTheme('dark'); toast('Dark theme'); });

  if(pdfFrame){
    pdfFrame.addEventListener('load', function(){
      pdfFrame.classList.add('ready');
      if(pdfLoader) pdfLoader.classList.remove('show');
    });
  }
  if(krFrame){
    krFrame.addEventListener('load', function(){
      if(krLoader) krLoader.classList.remove('show');
      syncKRTheme(); resizeKR();
      if ((localStorage.getItem('ga_lang') || 'en') === 'ko') toast('Korean page ready');
    });
  }
  window.addEventListener('resize', resizeKR);

  // Copy email
  const copyDone = ()=>{ btnCopyEmail.textContent='Copied!'; setTimeout(()=> btnCopyEmail.textContent='Copy Email', 1200); toast('Email copied'); };
  btnCopyEmail.addEventListener('click', function(){
    try{
      navigator.clipboard.writeText('gainauntu@gmail.com').then(copyDone, ()=>{
        const t = document.createElement('textarea');
        t.value = 'gainauntu@gmail.com'; document.body.appendChild(t); t.select(); document.execCommand('copy'); t.remove(); copyDone();
      });
    }catch(e){ copyDone(); }
  });

  // EN download (default) / KR print or auto-PDF (if http)
  btnDownloadPDF.setAttribute('download', 'GAIN_AUNTU_CV.pdf');
  btnDownloadPDF.addEventListener('click', async function(e){
    const lang = localStorage.getItem('ga_lang') || 'en';
    if (lang === 'en') return; // normal download

    e.preventDefault(); // KR intercept
    const isHttp = /^https?:/i.test(location.protocol);

    if (isHttp && window.html2pdf) {
      try{
        const res = await fetch(KR_URL, { credentials: 'same-origin' });
        if(!res.ok) throw new Error('Fetch failed: '+res.status);
        const html = await res.text();

        const box = document.createElement('div');
        box.style.cssText = 'position:fixed;left:-99999px;top:0;width:794px;background:#fff;color:#000;z-index:-1;';
        box.innerHTML = html;
        const st = document.createElement('style');
        st.textContent = 'html,body{background:#fff!important;color:#000!important;margin:0;padding:0;}img{max-width:100%;height:auto;display:block;}';
        box.prepend(st);
        document.body.appendChild(box);

        await html2pdf().set({
          margin: 0.5,
          filename: 'GAIN_AUNTU_KR.pdf',
          image: { type: 'jpeg', quality: 0.98 },
          html2canvas: { scale: 2, useCORS: true },
          jsPDF: { unit: 'in', format: 'a4', orientation: 'portrait' }
        }).from(box).save();

        document.body.removeChild(box);
        toast('Korean PDF downloaded');
        return;
      }catch(err){
        console.error(err);
        // Fall back to print
      }
    }

    try {
      if (!krFrame.getAttribute('src')) { btnKo.click(); }
      const win = krFrame.contentWindow;
      if (win && typeof win.print === 'function') { win.focus(); win.print(); return; }
    } catch(_) {}

    const w = window.open(KR_URL, '_blank', 'noopener,noreferrer');
    if (w) { setTimeout(()=>{ try{ w.focus(); w.print(); }catch(_){} }, 600); }
  });

  // Progress bar
  function onScroll(){
    const h = document.documentElement;
    const max = h.scrollHeight - h.clientHeight;
    const p = max > 0 ? (h.scrollTop / max) : 0;
    bar.style.transform = 'scaleX(' + p + ')';
  }
  document.addEventListener('scroll', onScroll, { passive:true });
  onScroll();

  /* ---------- Smooth Accent Cycler (no buttons) ---------- */
  // Palette of 5 stops (each has a, b, c for different roles)
  const PALETTE = [
    {a:'#4da3ff', b:'#00e6b8', c:'#8a7dff'},
    {a:'#ff8a4d', b:'#ffd34d', c:'#ff5d9e'},
    {a:'#22d3ee', b:'#34d399', c:'#60a5fa'},
    {a:'#c084fc', b:'#f472b6', c:'#fca5a5'},
    {a:'#7dd3fc', b:'#d8b4fe', c:'#a78bfa'}
  ];
  const CYCLE_MS = 18000; // 18s per blend

  function hexToRgb(h){
    const m = h.replace('#','');
    return [
      parseInt(m.substring(0,2),16),
      parseInt(m.substring(2,4),16),
      parseInt(m.substring(4,6),16)
    ];
  }
  function lerp(a,b,t){ return a + (b-a)*t; }
  function lerpRgb(c1,c2,t){ return [
    Math.round(lerp(c1[0],c2[0],t)),
    Math.round(lerp(c1[1],c2[1],t)),
    Math.round(lerp(c1[2],c2[2],t))
  ]; }
  function rgbStr(c){ return `rgb(${c[0]}, ${c[1]}, ${c[2]})`; }

  // Persist phase so refresh doesn't reset animation harshly
  let startEpoch = Number(localStorage.getItem('ga_accent_epoch') || Date.now());
  // Update epoch occasionally
  setInterval(()=> localStorage.setItem('ga_accent_epoch', String(startEpoch)), 120000);

  function animateAccent(ts){
    const now = (Date.now() - startEpoch) % (PALETTE.length * CYCLE_MS);
    const idx = Math.floor(now / CYCLE_MS);
    const next = (idx + 1) % PALETTE.length;
    const t = (now % CYCLE_MS) / CYCLE_MS;

    const p1 = PALETTE[idx], p2 = PALETTE[next];
    const a = lerpRgb(hexToRgb(p1.a), hexToRgb(p2.a), t);
    const b = lerpRgb(hexToRgb(p1.b), hexToRgb(p2.b), t);
    const c = lerpRgb(hexToRgb(p1.c), hexToRgb(p2.c), t);

    document.documentElement.style.setProperty('--accent', rgbStr(a));
    document.documentElement.style.setProperty('--accent-3', rgbStr(b));
    document.documentElement.style.setProperty('--accent-2', rgbStr(c));

    requestAnimationFrame(animateAccent);
  }
  requestAnimationFrame(animateAccent);

  /* ---------- Subtle 3D Mouse-Parallax Glow ---------- */
  let raf = null;
  let cx = window.innerWidth / 2;
  let cy = window.innerHeight / 2;
  let mx = cx, my = cy;

  window.addEventListener('mousemove', (e)=>{
    mx = e.clientX; my = e.clientY;
    if (!raf) {
      raf = requestAnimationFrame(updateParallax);
    }
  }, { passive:true });

  window.addEventListener('resize', ()=>{
    cx = window.innerWidth / 2;
    cy = window.innerHeight / 2;
  });

  function updateParallax(){
    raf = null;
    const dx = (mx - cx) / cx;  // -1..1
    const dy = (my - cy) / cy;  // -1..1

    // Glow follows pointer slightly
    const moveX = dx * 40; // px
    const moveY = dy * 40; // px
    glow.style.transform = `translate3d(${moveX}px, ${moveY}px, 0)`;

    // Tilt the viewer imperceptibly for depth
    const tiltX = dy * -2; // deg
    const tiltY = dx * 2;  // deg
    viewer.style.transform = `rotateX(${tiltX}deg) rotateY(${tiltY}deg)`;
  }

  // Init state
  const savedViewerTheme = localStorage.getItem('ga_viewer_theme') || (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
  applyViewerTheme(savedViewerTheme);
  const savedLang = localStorage.getItem('ga_lang') || 'en';
  showLang(savedLang);
  document.getElementById('y').textContent = new Date().getFullYear();

  // Initial progress bar update
  (function onScrollInit(){ const h = document.documentElement; const max = h.scrollHeight - h.clientHeight; bar.style.transform = 'scaleX(' + (max>0?(h.scrollTop/max):0) + ')'; })();
})();
</script>
</body>
</html>
